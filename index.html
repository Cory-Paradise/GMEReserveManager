<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Upcoming Game Releases</title>

  <style>
    :root{
      --bg:#0b0f14; --panel:#121826; --muted:#9aa4b2; --text:#e6edf3;
      --accent:#ff3b30; --border:rgba(255,255,255,.10); --chip:rgba(255,255,255,.06);
      --shadow:0 12px 34px rgba(0,0,0,.45);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:linear-gradient(180deg,#070a10,var(--bg));
      color:var(--text)
    }

    /* ===== Sticky header ===== */
    header{
      position:sticky;
      top:0;
      z-index:10;
      border-bottom:1px solid var(--border);
      background:rgba(11,15,20,.92);
      backdrop-filter:blur(10px);
      transition:padding .2s ease;
      padding:14px 16px 10px;
    }

    .wrap{max-width:1150px;margin:0 auto; position:relative}
    h1{margin:0 0 6px;font-size:20px}
    .sub{margin:0 0 14px;color:var(--muted);font-size:13px}

    /* ===== PROMO (always visible) ===== */
    .promo{
      position:sticky;
      top:0;
      z-index:20;
      background:linear-gradient(90deg,#ff3b30,#ff6b5e);
      color:#fff;
      font-weight:850;
      font-size:13px;
      padding:10px 16px;
      text-align:center;
      border-bottom:1px solid rgba(255,255,255,.20);
    }
    #promoText{
      display:inline-block;
      max-width:min(100%, 950px);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      vertical-align:middle;
    }
    .promoFadeOut{ opacity:0; transform:translateY(-2px); transition:opacity .25s ease, transform .25s ease; }
    .promoFadeIn{ opacity:1; transform:translateY(0); transition:opacity .25s ease, transform .25s ease; }

    /* ===== QR in top-right ===== */
    .qrWrap{
      position:absolute;
      right:12px;
      top:10px;
      z-index:30;
      display:flex;
      align-items:center;
      gap:10px;
      padding:8px 10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.35);
      box-shadow:0 10px 26px rgba(0,0,0,.35);
      backdrop-filter:blur(8px);
    }
    .qrWrap small{
      display:block;
      color:rgba(230,237,243,.85);
      font-size:11px;
      line-height:1.15;
      max-width:120px;
    }
    .qrWrap img{
      width:82px;
      height:82px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.16);
      background:#fff;
    }
    @media(max-width:900px){
      .qrWrap small{display:none;}
      .qrWrap img{width:70px;height:70px;}
    }
    @media(max-width:540px){
      .qrWrap{right:8px; top:8px; padding:6px;}
      .qrWrap img{width:62px;height:62px;}
    }

    /* Collapsible content inside header */
    .headerContent{
      transition:max-height .25s ease, opacity .2s ease, transform .25s ease;
      overflow:hidden;
      max-height:500px;
    }
    header.compact{
      padding:8px 16px 8px;
    }
    header.compact .headerContent{
      max-height:0;
      opacity:0;
      transform:translateY(-8px);
      pointer-events:none;
    }

    /* ===== Controls ===== */
    .controls{display:grid;gap:10px;grid-template-columns:1fr 180px 190px;align-items:center}
    @media(max-width:820px){.controls{grid-template-columns:1fr}}
    input,select{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid var(--border);
      background:var(--panel);
      color:var(--text);
      outline:none
    }
    input::placeholder{color:rgba(154,164,178,.8)}

    .tabs{display:flex;gap:8px;padding:14px 0 0;flex-wrap:wrap}
    .tab{
      padding:9px 12px;border-radius:999px;border:1px solid var(--border);
      background:var(--chip);font-size:13px;cursor:pointer;user-select:none
    }
    .tab.active{background:rgba(255,59,48,.18);border-color:rgba(255,59,48,.35)}

    /* ===== Main ===== */
    main{padding:14px 16px 30px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:14px}
    @media(max-width:420px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}

    /* ===== Tiles ===== */
    .tile{
      position:relative;
      border-radius:14px;
      overflow:hidden;
      border:1px solid var(--border);
      background:rgba(18,24,38,.75);
      box-shadow:var(--shadow);
      cursor:pointer;
      display:flex;
      flex-direction:column;
      transform:translateZ(0);
      transition:transform .12s ease, box-shadow .12s ease;
    }
    .tile:hover{transform:translateY(-1px)}
    .tile:active{transform:scale(.99)}

    /* Featured gradient border */
    .tile.featured{
      border-color:transparent;
    }
    .tile.featured::before{
      content:"";
      position:absolute;
      inset:0;
      padding:1px; /* thin border */
      border-radius:14px;
      background:linear-gradient(135deg, rgba(255,59,48,.95), rgba(255,255,255,.18), rgba(255,59,48,.70));
      -webkit-mask:
        linear-gradient(#000 0 0) content-box,
        linear-gradient(#000 0 0);
      -webkit-mask-composite:xor;
      mask-composite:exclude;
      pointer-events:none;
    }
    .tile.featured::after{
      content:"";
      position:absolute;
      inset:0;
      border-radius:14px;
      box-shadow:0 0 0 1px rgba(255,59,48,.10), 0 16px 44px rgba(0,0,0,.35);
      pointer-events:none;
    }

    .cover{
      width:100%;
      aspect-ratio:3/4;
      object-fit:cover;
      display:block;
      background:linear-gradient(135deg,rgba(255,255,255,.05),rgba(255,255,255,.02));
    }

    .badge{
      position:absolute;top:10px;right:10px;
      padding:6px 10px;border-radius:999px;
      font-size:11px;font-weight:800;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.18);
      backdrop-filter:blur(6px)
    }

    .info{
      padding:10px 10px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
      flex:1;
      min-height:0;
    }

    .title{
      font-weight:750;
      font-size:13px;
      line-height:1.25;
      overflow:hidden;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
    }

    .meta{
      color:var(--muted);
      font-size:12px;
      display:flex;
      justify-content:space-between;
      gap:8px;
      align-items:center;
      margin-top:auto;
      min-width:0;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:5px 9px;
      border-radius:999px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      font-size:11px;
      white-space:nowrap;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      min-width:0;
    }

    /* Empty state + footer */
    .empty{margin-top:18px;padding:18px;border:1px dashed var(--border);border-radius:14px;color:var(--muted)}
    footer{padding:14px 16px 30px;color:var(--muted);font-size:12px;border-top:1px solid var(--border)}
    code{color:rgba(230,237,243,.9)}

    /* ===== Modal ===== */
    .overlay{position:fixed;inset:0;background:rgba(0,0,0,.70);display:none;z-index:999}
    .overlay.show{display:block}
    .modal{
      position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);
      width:min(980px,calc(100vw - 24px));max-height:calc(100vh - 24px);
      overflow:auto;border-radius:16px;border:1px solid var(--border);
      background:rgba(18,24,38,.95);box-shadow:var(--shadow);display:none;z-index:1000
    }
    .modal.show{display:block}
    .modalHead{
      display:flex;justify-content:space-between;align-items:flex-start;gap:12px;
      padding:14px 14px 10px;border-bottom:1px solid var(--border)
    }
    .modalTitle{font-size:18px;font-weight:850;margin:0}
    .closeBtn{
      border:1px solid var(--border);background:rgba(255,255,255,.06);color:var(--text);
      border-radius:12px;padding:8px 10px;cursor:pointer;font-weight:800
    }
    .modalBody{display:grid;grid-template-columns:1.2fr .8fr;gap:14px;padding:14px}
    @media(max-width:860px){.modalBody{grid-template-columns:1fr}}

    .heroWrap{border:1px solid var(--border);border-radius:14px;overflow:hidden;background:rgba(255,255,255,.03)}
    .heroImg{width:100%;aspect-ratio:16/9;object-fit:cover;display:block}
    .thumbs{display:flex;gap:8px;flex-wrap:wrap;padding:10px}
    .thumb{
      width:86px;aspect-ratio:16/9;object-fit:cover;border-radius:10px;border:1px solid var(--border);
      cursor:pointer;opacity:.85
    }
    .thumb.active{outline:2px solid rgba(255,59,48,.55);opacity:1}
    .desc{color:rgba(230,237,243,.92);line-height:1.4;font-size:13px}
    .kv{display:grid;gap:10px}
    .kvBlock{border:1px solid var(--border);border-radius:14px;background:rgba(255,255,255,.04);padding:12px}
    .kvLabel{color:var(--muted);font-size:12px;margin-bottom:6px}
    .kvValue{font-weight:800}
    .platforms{display:flex;gap:8px;flex-wrap:wrap}
  </style>
</head>

<body>
  <header>
    <!-- PROMO BANNER (always visible) -->
    <div class="promo">
      <span id="promoText"></span>
    </div>

    <!-- QR top-right -->
    <div class="wrap">
      <div class="qrWrap" title="Scan to open the website">
        <small>Scan to open<br>on your phone</small>
        <img
          alt="QR code"
          src="https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=https%3A%2F%2Fcory-paradise.github.io%2FGMEReserveManager%2F"
        />
      </div>
    </div>

    <!-- COLLAPSIBLE CONTENT -->
    <div class="headerContent">
      <div class="wrap">
        <h1>Upcoming Releases</h1>
        <p class="sub">Tile view + details popup (release date, platforms, description, pictures).</p>

        <div class="controls">
          <input id="search" placeholder="Search title (e.g., Mario, Assassin)..." />
          <select id="sort">
            <option value="dateAsc">Sort: Date (Soonest)</option>
            <option value="dateDesc">Sort: Date (Latest)</option>
            <option value="titleAsc">Sort: Title (A–Z)</option>
            <option value="titleDesc">Sort: Title (Z–A)</option>
          </select>
          <select id="showPast">
            <option value="hide">Hide Past Releases</option>
            <option value="show">Show Past Releases</option>
          </select>
        </div>

        <div class="tabs">
          <div class="tab active" data-filter="all">All Systems</div>
          <div class="tab" data-filter="PlayStation">PlayStation</div>
          <div class="tab" data-filter="Xbox">Xbox</div>
          <div class="tab" data-filter="Switch">Switch</div>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div id="grid" class="grid"></div>
    <div id="empty" class="empty" style="display:none;">No games match your filters.</div>
  </main>

  <footer>
    <div class="wrap">
      Tip: Put images in folders like <code>covers/</code> and <code>screens/</code> in your repo, then reference them in the <code>games</code> list.
    </div>
  </footer>

  <!-- Modal -->
  <div id="overlay" class="overlay"></div>
  <div id="modal" class="modal" role="dialog" aria-modal="true">
    <div class="modalHead">
      <div>
        <h2 id="mTitle" class="modalTitle"></h2>
        <div id="mSub" class="meta" style="margin-top:6px;"></div>
      </div>
      <button id="closeBtn" class="closeBtn">Close</button>
    </div>
    <div class="modalBody">
      <div>
        <div class="heroWrap">
          <img id="heroImg" class="heroImg" alt="Screenshot" />
          <div id="thumbs" class="thumbs"></div>
        </div>
        <div style="height:12px"></div>
        <div id="mDesc" class="desc"></div>
      </div>

      <div class="kv">
        <div class="kvBlock">
          <div class="kvLabel">Release date</div>
          <div id="mDate" class="kvValue"></div>
        </div>
        <div class="kvBlock">
          <div class="kvLabel">Platforms</div>
          <div id="mPlatforms" class="platforms"></div>
        </div>
        <div class="kvBlock">
          <div class="kvLabel">Notes (optional)</div>
          <div id="mNote" class="desc"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== Data =====
    // Add featured:true to give a thin red gradient border around "hot" titles.
    const games = [
      {
        title: "Resident Evil Requiem",
        date: "2026-02-27",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/resident-evil-requiem.jpg",
        description: "A dark new chapter in the Resident Evil saga, blending survival horror with cinematic storytelling. Expect classic tension, modern combat, and a haunting narrative.",
        screenshots: [],
        note: "Horror • Story • Action",
        featured: true
      },
      {
        title: "Trails Beyond Horizon",
        date: "2026-03-14",
        platforms: ["PlayStation", "Switch", "Xbox"],
        cover: "covers/trails-beyond-horizon.jpg",
        description: "The next entry in the Trails series expands the world with new regions, political intrigue, and deep turn-based combat.",
        screenshots: [],
        note: "JRPG • Story-heavy"
      },
      {
        title: "Crimson Desert",
        date: "2026-04-18",
        platforms: ["PlayStation", "Xbox"],
        cover: "covers/crimson-desert.jpg",
        description: "An open-world action RPG set in a brutal medieval fantasy world, built around intense combat, massive battles, and a gritty narrative.",
        screenshots: [],
        note: "Open-world action RPG"
      },
      {
        title: "WWE 2K26",
        date: "2026-03-08",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/wwe-2k26.jpg",
        description: "The latest WWE 2K installment with expanded match types, updated roster, and deeper MyGM and Universe style modes.",
        screenshots: [],
        note: "Sports • Multiplayer"
      },
      {
        title: "LEGO Batman",
        date: "2026-05-10",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/lego-batman.jpg",
        description: "A LEGO adventure through Gotham featuring classic heroes and villains, puzzle-solving, humor, and co-op play.",
        screenshots: [],
        note: "Family-friendly • Co-op"
      },
      {
        title: "Pragmata",
        date: "2026-06-01",
        platforms: ["PlayStation", "Xbox"],
        cover: "covers/pragmata.jpg",
        description: "Capcom’s mysterious sci-fi action title with a strategic twist—expect hacking/tech elements alongside cinematic combat.",
        screenshots: [],
        note: "Sci-fi • Action"
      },
      {
        title: "Dragon Quest VII",
        date: "2026-02-05",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/dragon-quest-vii.jpg",
        description: "A reimagined classic JRPG with turn-based combat, a huge adventure, and the signature charm of the Dragon Quest series.",
        screenshots: [],
        note: "Classic JRPG",
        featured: true
      },
      {
        title: "Tales of Berseria",
        date: "2026-02-26",
        platforms: ["PlayStation", "Switch"],
        cover: "covers/tales-of-berseria.jpg",
        description: "An action RPG following Velvet Crowe on a revenge-driven journey, known for fast combat and character-focused storytelling.",
        screenshots: [],
        note: "Action RPG"
      },
      {
        title: "007: First Light",
        date: "2026-09-20",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/007-first-light.jpg",
        description: "An original James Bond origin story focusing on stealth, gadgets, and cinematic espionage before he becomes 007.",
        screenshots: [],
        note: "Stealth • Espionage",
        featured: true
      },
      {
        title: "Life Is Strange: Reunion",
        date: "2026-07-12",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/life-is-strange-reunion.jpg",
        description: "A choice-driven narrative adventure with emotional storytelling and supernatural elements, exploring memory and consequence.",
        screenshots: [],
        note: "Story-focused"
      },
      {
        title: "Styx: Blades of Greed",
        date: "2026-02-19",
        platforms: ["PlayStation", "Xbox"],
        cover: "covers/styx-blades-of-greed.jpg",
        description: "Stealth action starring Styx, the goblin assassin—tactical sneaking, vertical level design, and dark humor.",
        screenshots: [],
        note: "Stealth"
      },
      {
        title: "Monster Hunter Stories 3",
        date: "2026-08-22",
        platforms: ["PlayStation", "Switch", "Xbox"],
        cover: "covers/monster-hunter-stories-3.jpg",
        description: "A turn-based RPG spin-off focused on bonding with monsters and exploring a colorful world with party-based battles.",
        screenshots: [],
        note: "Turn-based RPG"
      },
      {
        title: "Saros",
        date: "2026-10-03",
        platforms: ["PlayStation"],
        cover: "covers/saros.jpg",
        description: "A sci-fi action adventure on a hostile alien world, blending atmospheric exploration with intense combat.",
        screenshots: [],
        note: "Sci-fi • Action"
      },
      {
        title: "Mega Man Starforce",
        date: "2026-11-15",
        platforms: ["PlayStation", "Switch"],
        cover: "covers/mega-man-starforce.jpg",
        description: "A revival of the Star Force style with action RPG mechanics, real-time battles, and a futuristic cyber-themed story.",
        screenshots: [],
        note: "Action RPG"
      },
      {
        title: "RollerCoaster Tycoon 3",
        date: "2026-04-05",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/rollercoaster-tycoon-3.jpg",
        description: "Build and manage the ultimate theme park with creative coaster design, guest management, and sandbox play.",
        screenshots: [],
        note: "Simulation"
      },
      {
        title: "Invincible VS",
        date: "2026-09-01",
        platforms: ["PlayStation", "Xbox"],
        cover: "covers/invincible-vs.jpg",
        description: "A high-impact arena fighter in the Invincible universe with explosive hits, big character moments, and chaotic battles.",
        screenshots: [],
        note: "Fighting"
      },
      {
        title: "My Hero Academia: All’s Justice",
        date: "2026-02-06",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/my-hero-academia-alls-justice.jpg",
        description: "Anime arena fighter featuring heroes and villains from My Hero Academia, built around fast battles and cinematic super moves.",
        screenshots: [],
        note: "Anime fighter"
      },
      {
        title: "Mario Tennis",
        date: "2026-03-22",
        platforms: ["Switch"],
        cover: "covers/mario-tennis.jpg",
        description: "Fast arcade tennis starring Mario and friends, with accessible controls, advanced techniques, and competitive local multiplayer.",
        screenshots: [],
        note: "Local multiplayer",
        featured: true
      },
      {
        title: "Yakuza 3 / Darktides",
        date: "2026-06-18",
        platforms: ["PlayStation", "Xbox"],
        cover: "covers/yakuza-3-darktides.jpg",
        description: "A brawler-style crime drama experience with narrative-driven action and a ton of side activities.",
        screenshots: [],
        note: "Action • Story"
      },
      {
        title: "Forza Horizon 6",
        date: "2026-10-15",
        platforms: ["Xbox"],
        cover: "covers/forza-horizon-6.jpg",
        description: "The next entry in the open-world racing franchise with a new location, big car list, and refined arcade-style driving.",
        screenshots: [],
        note: "Racing",
        featured: true
      },
      {
        title: "Nioh 3",
        date: "2026-02-06",
        platforms: ["PlayStation"],
        cover: "covers/nioh-3.jpg",
        description: "Hardcore action RPG with fast, technical combat, deep builds, and challenging encounters in a dark fantasy setting.",
        screenshots: [],
        note: "Action RPG"
      },
      {
        title: "Reanimal",
        date: "2026-02-13",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/reanimal.jpg",
        description: "A dark co-op horror adventure with exploration and environmental puzzles, focused on tense atmosphere and unsettling creatures.",
        screenshots: [],
        note: "Co-op horror"
      },
      {
        title: "Marvel Cosmic Invasion",
        date: "2026-09-30",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/marvel-cosmic-invasion.jpg",
        description: "A superhero action game with a cosmic-scale storyline, character abilities, and cinematic combat moments.",
        screenshots: [],
        note: "Superhero action"
      },
      {
        title: "Bendy and the Ink Machine",
        date: "2026-04-12",
        platforms: ["PlayStation", "Xbox", "Switch"],
        cover: "covers/bendy-and-the-ink-machine.jpg",
        description: "First-person horror puzzle adventure in an abandoned animation studio—heavy on atmosphere, exploration, and cartoon-horror style.",
        screenshots: [],
        note: "Horror puzzle"
      },
      {
        title: "UFO 50",
        date: "2026-05-28",
        platforms: ["PlayStation", "Switch"],
        cover: "covers/ufo-50.jpg",
        description: "A collection of 50 original retro-inspired games across genres, presented as a fictional 1980s studio catalog.",
        screenshots: [],
        note: "Retro collection"
      },
      {
        title: "Death Howl",
        date: "2026-11-08",
        platforms: ["PlayStation", "Xbox"],
        cover: "covers/death-howl.jpg",
        description: "Dark action adventure blending fast combat with eerie environments and intense boss fights.",
        screenshots: [],
        note: "Dark fantasy action"
      }
    ];

    // ===== DOM =====
    const gridEl = document.getElementById("grid");
    const emptyEl = document.getElementById("empty");
    const searchEl = document.getElementById("search");
    const sortEl = document.getElementById("sort");
    const showPastEl = document.getElementById("showPast");
    const tabs = Array.from(document.querySelectorAll(".tab"));

    const overlay = document.getElementById("overlay");
    const modal = document.getElementById("modal");
    const closeBtn = document.getElementById("closeBtn");

    const mTitle = document.getElementById("mTitle");
    const mSub = document.getElementById("mSub");
    const mDesc = document.getElementById("mDesc");
    const mDate = document.getElementById("mDate");
    const mPlatforms = document.getElementById("mPlatforms");
    const mNote = document.getElementById("mNote");
    const heroImg = document.getElementById("heroImg");
    const thumbs = document.getElementById("thumbs");

    let activeFilter = "all";

    // ===== Helpers =====
    function parseDate(d){
      const [y,m,day]=d.split("-").map(Number);
      return new Date(y,m-1,day);
    }
    function formatDateLong(d){
      return parseDate(d).toLocaleDateString(undefined,{year:"numeric",month:"long",day:"numeric"});
    }
    function formatDateShort(d){
      return parseDate(d).toLocaleDateString(undefined,{month:"short",day:"numeric"});
    }
    function isPast(d){
      const today=new Date(); today.setHours(0,0,0,0);
      return parseDate(d) < today;
    }
    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g,(m)=>({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      }[m]));
    }

    // ===== Render =====
    function render(){
      const q = searchEl.value.trim().toLowerCase();
      const showPast = showPastEl.value === "show";

      // If any PC/Mobile accidentally sneak in, exclude them
      let filtered = games.filter(g =>
        !(g.platforms || []).includes("PC") &&
        !(g.platforms || []).includes("Mobile")
      );

      if(activeFilter !== "all"){
        filtered = filtered.filter(g => (g.platforms || []).includes(activeFilter));
      }

      if(!showPast){
        filtered = filtered.filter(g => !isPast(g.date));
      }

      if(q){
        filtered = filtered.filter(g => (g.title || "").toLowerCase().includes(q));
      }

      const sort = sortEl.value;
      filtered.sort((a,b)=>{
        if(sort==="dateAsc") return parseDate(a.date)-parseDate(b.date);
        if(sort==="dateDesc") return parseDate(b.date)-parseDate(a.date);
        if(sort==="titleAsc") return (a.title||"").localeCompare(b.title||"");
        if(sort==="titleDesc") return (b.title||"").localeCompare(a.title||"");
        return 0;
      });

      gridEl.innerHTML = "";
      if(filtered.length === 0){
        emptyEl.style.display="block";
        return;
      }
      emptyEl.style.display="none";

      filtered.forEach((g)=>{
        const tile = document.createElement("div");
        tile.className = "tile" + (g.featured ? " featured" : "");

        tile.innerHTML = `
          <img class="cover" src="${escapeHtml(g.cover || "")}" alt="${escapeHtml(g.title)} cover"
            loading="lazy"
            onerror="this.style.display='none'; this.insertAdjacentHTML('afterend','<div class=\\'cover\\' style=\\'display:grid;place-items:center;padding:16px;color:rgba(230,237,243,.85)\\'>No cover image</div>');">
          <div class="badge">${escapeHtml(formatDateShort(g.date))}</div>
          <div class="info">
            <div class="title">${escapeHtml(g.title)}</div>
            <div class="meta">
              <span class="pill" title="${escapeHtml((g.platforms||[]).join(' / '))}">
                ${escapeHtml((g.platforms||[]).join(" / ") || "—")}
              </span>
            </div>
          </div>
        `;

        tile.addEventListener("click", ()=>openModal(g));
        gridEl.appendChild(tile);
      });
    }

    // ===== Modal =====
    function openModal(g){
      mTitle.textContent = g.title || "";
      mSub.textContent = (g.platforms || []).join(" / ") + " • " + formatDateLong(g.date);
      mDesc.textContent = g.description || "";
      mDate.textContent = formatDateLong(g.date);

      mPlatforms.innerHTML = "";
      (g.platforms || []).forEach(p=>{
        const chip = document.createElement("span");
        chip.className = "pill";
        chip.textContent = p;
        mPlatforms.appendChild(chip);
      });

      mNote.textContent = g.note ? g.note : "—";

      const pics = (g.screenshots && g.screenshots.length) ? g.screenshots : [g.cover].filter(Boolean);
      thumbs.innerHTML = "";

      function setHero(i){
        heroImg.src = (pics[i] || "");
        Array.from(thumbs.children).forEach((t, idx)=>t.classList.toggle("active", idx===i));
      }

      pics.forEach((src, i)=>{
        const t = document.createElement("img");
        t.className = "thumb" + (i===0 ? " active" : "");
        t.src = src;
        t.alt = "Screenshot " + (i+1);
        t.loading = "lazy";
        t.addEventListener("click", (e)=>{ e.stopPropagation(); setHero(i); });
        thumbs.appendChild(t);
      });

      setHero(0);

      overlay.classList.add("show");
      modal.classList.add("show");
    }

    function closeModal(){
      overlay.classList.remove("show");
      modal.classList.remove("show");
    }

    overlay.addEventListener("click", closeModal);
    closeBtn.addEventListener("click", closeModal);
    document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") closeModal(); });

    // ===== Tabs / Controls =====
    tabs.forEach(t=>{
      t.addEventListener("click", ()=>{
        tabs.forEach(x=>x.classList.remove("active"));
        t.classList.add("active");
        activeFilter = t.dataset.filter;
        render();
      });
    });

    searchEl.addEventListener("input", render);
    sortEl.addEventListener("change", render);
    showPastEl.addEventListener("change", render);

    // ===== Header compact on scroll (promo stays visible) =====
    const headerEl = document.querySelector("header");
    window.addEventListener("scroll", () => {
      headerEl.classList.toggle("compact", window.scrollY > 120);
    }, { passive: true });

    // ===== Rotating promo banner (5s) =====
    const promos = [
      "Trade in any games towards a new preorder and get 20% Extra Credit!!",
      "Buy a new Game and get $10 off a Pro Membership!!",
      "Pre-order Resident Evil Requiem today!!",
      "Pre-order Ascended Heroes ETB Today!!"
    ];
    const promoTextEl = document.getElementById("promoText");
    let promoIndex = 0;

    function setPromo(i){
      promoTextEl.classList.remove("promoFadeIn");
      promoTextEl.classList.add("promoFadeOut");
      setTimeout(()=>{
        promoTextEl.textContent = promos[i];
        promoTextEl.classList.remove("promoFadeOut");
        promoTextEl.classList.add("promoFadeIn");
      }, 220);
    }
    setPromo(promoIndex);
    setInterval(()=>{
      promoIndex = (promoIndex + 1) % promos.length;
      setPromo(promoIndex);
    }, 5000);

    // ===== Go =====
    render();
  </script>
</body>
</html>
